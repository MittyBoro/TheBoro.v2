---
title: 'Видео Платформа (18+)'
description: 'Большое приложение из четырёх частей: Nuxt-фронт, отдельная Nuxt-панель, Laravel-API и Laravel-сервис для FFmpeg.'
date: 2024-11-01
published: true
tags:
  - E-commerce
  - Nuxt
  - Laravel
  - FFmpeg
  - Sanctum
  - Tailwind
preview: /content/projects/streaming_service.png
github: https://github.com/MittyBoro#portfolio
---

## О проекте

Внутри — полноценная VOD/стриминговая платформа для взрослых (18+) с отдельными фронтом и панелью, API-бэкендом и микросервисом для обработки медиаконтента на FFmpeg.

## Архитектура (4 сервиса)

1. **Фронтенд (Nuxt 3):** публичный сайт, подключённый к Laravel-API, с упором на производительность, кэш и SEO.
2. **Панель управления (Nuxt 3):** интерфейс для редакции и модерации с аутентификацией через Sanctum, графиками и редактором контента.
3. **Бэкенд (Laravel):** версионированное API (V1 — публичная часть, V2 — панель), собственная доменная модель, внутренняя валюта (coins) и реферальная механика.
4. **FFmpeg-сервис (Laravel):** отдельный API для сплитов/превью/трейлеров/ресайза видео, работающий в Docker со своими очередями.

---

## Фронтенд: NuxtStreamingWebsite

**Стек и модули:** Nuxt 3, Laravel Echo и Pusher для realtime, SASS, Day.js, Swiper; модули `@nuxt/image`, `@nuxtjs/google-fonts`, `@nuxtjs/sitemap`, `nuxt-schema-org`. Правила кэширования и оптимизация под PageSpeed заложены с коробки.

**Что важно по UX/SEO:** оптимизированные изображения и ленивая загрузка через `@nuxt/image`, генерация sitemap и микроразметка Schema.org; чистая верстка и слайдеры там, где они действительно повышают конверсию (подборки, рекомендации).

**Realtime-слои:** уведомления и события через Pusher/Echo — фронт сразу реагирует на изменения (например, статусные апдейты задач/контента из админки).

---

## Панель управления: NuxtControlPanelApplication

**Стек:** Nuxt 3, Tailwind + Nuxt UI, Chart.js для графиков, Tiptap как rich-текст, Pusher для realtime, связь с API — Sanctum. Есть светлая/тёмная темы и авто-переключение.

**Функциональные блоки:** аутентификация (login/logout, защищённые маршруты), таблицы со списками и фильтрами, визуализации метрик, удобное редактирование описаний с загрузкой изображений, нотификации. Панель — «тонкий» клиент без лишней бизнес-логики

---

## Бэкенд: BrazApp.v3 (Laravel API)

**Версионирование и структура:** `api/v1` — публичная витрина, `api/v2` — для панели. Основная доменная логика инкапсулирована в репозитории (`App\Repositories`), контроллер → репозиторий и репозиторий → модель меппятся по соглашениям нейминга.

**Миграции и макросы схемы:** сервис-провайдер с макросами упрощает часто повторяемые поля: SEO-мета, публикация (флаги/дата), `slug`, привязки к пользователю, валюта. Это ускоряет вывод новых сущностей без болтовни в миграциях.

**Пользователи и монетизация:** внутренняя валюта **coins** — начисление за рефералов (процент от действий приглашённого), трата на премиум и ручные заявки на вывод.

**Разработка и окружение:** Sail + Docker, готовые команды миграций/сидов, понятный bootstrap для локальной поднятия. :contentReference[oaicite:14]{index=14}

---

## Микросервис медиа: LaravelFFmpegAplication

**Назначение:** отдельный Laravel-сервис с REST-API поверх FFmpeg 6 (через `protonemedia/laravel-ffmpeg`). Принимает исходный `src`, создаёт задания, обрабатывает в очередях (DB-driver) и уведомляет вебхуком о прогрессе/завершении. Собран в Docker, поднимается через Sail.

**Поток обработки:** панель/бэкенд создаёт задачу → FFmpeg-сервис кладёт её в очередь → при завершении бьёт по `webhook_url` → панель видит обновление через Pusher (realtime), а фронт получает уже готовые превью/кадры. (Логика подтверждена по интерфейсам API и используемым библиотекам.)

---

## Данные и взаимодействия (как всё стыкуется)

- **Панель (Nuxt 3)** авторизуется через **Sanctum**, редактирует сущности и запускает фоновые операции — всё через эндпоинты `api/v2`.
- **Публичный фронт (Nuxt 3)** читает `api/v1`, получает кэшируемые страницы/списки, инициализирует Echo/Pusher для событий.
- **FFmpeg-сервис** — изолированный воркер медиа-процессинга с очередями и вебхуками, не смешивает бизнес-логику с API-слоем.

---

## Производительность и SEO

На фронте — `@nuxt/image` (оптимизация и lazy), `nuxt-purgecss` (минимизация стилей), sitemap и Schema.org; «зелёные» показатели PageSpeed. Реалтайм-канал через Pusher не мешает TTI за счёт ленивых инициализаций.

Минимизация JS и CSS, использование CDN.

Оптимизация бэкенда — кэширование запросов, индексы в БД.

## Роль и объём работ

За год+ собрал всю связку: фронт (Nuxt 3), панель (Nuxt 3), Laravel-API (V1/V2, coins/рефералы) и отдельный FFmpeg-микросервис с очередями и вебхуками. Каждая часть самостоятельна, но договороспособна по API, поэтому проект легко разворачивается и поддерживается по слоям.

## Статус

Проект закрыт; живых демо нет.
